##############################
### WINDOWS AND WORKSPACES ###
##############################

# Documentation: https://wiki.hyprland.org/Configuring/Window-Rules/
# Hyprland v0.53 Config

# -----------------------------------------------------
# UI Dialogs & Popups (Static Rules)
# -----------------------------------------------------

# XDG Desktop Portal (File Pickers)
windowrule {
    name = xdg-portal-center
    match:initial_class = ^(xdg-desktop-portal-gtk)$
    match:initial_title = ^(Open File|Open Files|Open Folder|Set Directory)$
    
    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = xdg-portal-downloads
    match:initial_class = ^(xdg-desktop-portal-gtk)$
    match:initial_title = ^(All Files|Download Location|Open Folder)$

    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = Xdg-portal-center
    match:initial_class = ^(Xdg-desktop-portal-gtk)$
    match:initial_title = ^(Open File|Open Files|Open Folder|Set Directory)$
    
    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = Xdg-portal-downloads
    match:initial_class = ^(Xdg-desktop-portal-gtk)$
    match:initial_title = ^(All Files|Download Location|Open Folder)$

    float = on
    center = on
    size = 1177 699
}

# Discord/Electron File Pickers (Blob URLs)
windowrule {
    name = discord-blob
    match:initial_class = ^(Xdg-desktop-portal-gtk)$
    match:initial_title = ^(blob:https://discord.com/.*)

    float = on
    center = on
    size = 1177 699
}

# Hyprland Share Picker
windowrule {
    name = hyprland-share
    match:initial_class = ^(hyprland-share-picker)$
    match:initial_title = ^(Select what to share)$

    float = on
    center = on
}

# Zen Browser Dialogs
windowrule {
    name = zen-pip
    match:initial_class = ^(zen)$
    match:initial_title = ^(Picture-in-Picture)$

    float = on
    center = on
}

windowrule {
    name = zen-uploads
    match:initial_class = ^(zen)$
    match:initial_title = ^(File Upload.*|Save Image|Enter name of file.*)$

    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = zen-library
    match:initial_class = ^(zen)$
    match:initial_title = ^(Library)$

    float = on
    center = on
    size = 1177 699
}

# AB Download Manager
windowrule {
    name = ab-download-manager
    match:initial_class = ^(com-abdownloadmanager-desktop-AppKt|java-lang-Thread)$
    match:initial_title = ^(AB Download Manager|Add Download)$
    match:title = ^(AB Download Manager|Add Download)$

    float = on
    center = on
}

# Blueman (Bluetooth) Dialogs
windowrule {
    name = blueman-plugins
    match:initial_class = ^(blueman-applet)$
    match:initial_title = ^(Plugins)$

    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = blueman-services
    match:initial_class = ^(blueman-services)$
    match:initial_title = ^(Local Services|Select folder for incoming file transfers)$

    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = blueman-sendto
    match:initial_class = ^(blueman-sendto)$
    match:initial_title = ^(Send files to send|Select files to send|Bluetooth File Transfer)$

    float = on
    center = on
    size = 1177 699
}

# Steam Settings & Dialogs
windowrule {
    name = steam-settings
    match:initial_class = ^(steam)$
    match:initial_title = ^(Steam Settings|Add Non-Steam Game|Steam Runtime System Information|System Information|System Report)$

    float = on
    center = on
    size = 991 756
}

# Nemo File Manager Dialogs
windowrule {
    name = nemo-props
    match:initial_class = ^(nemo)$
    match:initial_title = (.*)( Properties)

    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = nemo-prefs
    match:initial_class = ^(nemo)$
    match:initial_title = ^(Folder Sharing|File Management Preferences)$

    float = on
    center = on
    size = 1177 699
}

windowrule {
    name = nemo-encryption
    match:initial_class = ^(nemo-seahorse-tool)$
    match:initial_title = ^(Encryption settings|Choose Signer)$

    float = on
    center = on
    size = 1177 699
}

# Nemo Operations (Copying/Moving) - Dynamic Rule
# windowrule {
#     name = nemo-progress
#     match:initial_class = ^(nemo)$
#     match:initial_title = ^(Preparing|Preparing to copy .*|.* of .*)
#
#     stay_focused = on
# }

# Network Manager Editor
windowrule {
    name = nm-editor
    match:initial_class = ^(nm-connection-editor)$
    match:initial_title = ^(Network Connections|Editing .*)

    float = on
    center = on
    size = 1177 699
}

# iwgtk (Wifi)
windowrule {
    name = iwgtk-main
    match:initial_class = ^(org.twosheds.iwgtk)$
    match:initial_title = ^(iwgtk)$

    float = on
    center = on
}

windowrule {
    name = iwgtk-creds
    match:initial_class = ^(iwgtk)$
    match:initial_title = ^(Wireless network credentials|.*: Station diagnostics)$

    float = on
    center = on
}

# LibreOffice Dialogs
windowrule {
    name = libreoffice-dialogs
    match:initial_class = ^(soffice)$
    match:initial_title = ^(Save|Open)$

    float = on
    center = on
    size = 1177 699
}

# KDE Polkit Agent (Authentication)
windowrule {
    name = polkit-kde
    match:initial_class = ^(org.kde.polkit-kde-authentication-agent-1)$
    match:initial_title = ^(Authentication Required)$

    stay_focused = on
    pin = on
}

# KDE Connect File Receiver Dialog
windowrule {
    name = kdeconnect-filerecv
    match:initial_class = ^(org.kde.kdeconnect.daemon)$
    match:initial_title = ^(Receiving file â€” KDE Connect Daemon)$

    float = on
    center = on
    size = 1177 699
}

# VLC Media Player Dialogs
windowrule {
    name = vlc-dialogs
    match:initial_class = ^(vlc)$
    match:initial_title = ^(Adjustments and Effects|Current Media Information|VLM configurator|Program Guide|Messages|Plugins and extensions|Toolbars Editor|Simple Preferences)$

    float = on
    center = on
    size = 1177 699
}

# Krita Splash/Startup
windowrule {
    name = krita-splash
    match:initial_class = ^(krita)$
    match:initial_title = ^(Krita)$

    opaque = on
    no_blur = on
}

# GIMP Color Dialogs
windowrule {
    name = gimp-color
    match:initial_class = ^(gimp)$
    match:initial_title = ^(Change .* Color)$

    no_focus = on
    no_blur = on
    opaque = on
    stay_focused = on
    suppress_event = urgent
    size = 834 642
}

# Findex App Launcher
windowrule {
    name = findex
    match:class = ^(findex)$
    
    float = on
    no_anim = on
    border_size = 0 
    no_shadow = on
}

# Zero-Tier GUI
windowrule {
    name = zerotier
    match:initial_class = ^(Zerotier-gui)$
    match:initial_title = ^(ZeroTier-GUI)$

    float = on
    center = on
}

# OnlyOffice Desktop Editor
windowrule {
    name = onlyoffice-file-dialog
    match:initial_class = ^(DesktopEditors)$
    match:initial_title = ^(Save As|Open Document)$

    float = on
    center = on
    size = 1177 699
}

# -----------------------------------------------------
# General Behavior Rules
# -----------------------------------------------------

# Ignore maximize requests (Dynamic)
windowrule {
    name = ignore-maximize
    match:class = .*
    suppress_event = maximize
}

# Fix XWayland Dragging Issues
windowrule {
    name = xwayland-fix
    match:xwayland = on
    match:float = on
    match:fullscreen = false
    match:pin = false
    match:class = ^$
    match:title = ^$

    no_focus = on
}

# Fullscreen Border Colors (Dynamic)
windowrule {
    name = fullscreen-border-color
    match:fullscreen_state_internal = 1
    border_color = rgba(FF6600FF) rgba(FFAA00FF) 90deg
}


# -----------------------------------------------------
# Workspace Assignments (Static Rules)
# -----------------------------------------------------

# Workspace 1: Browsers
windowrule {
    name = workspace-zen
    match:initial_class = ^(zen)$
    match:initial_title = ^(Zen Browser)$
    workspace = 1
}

# Workspace 2: Chat & Communication
windowrule {
    name = workspace-vesktop
    match:initial_class = ^(vesktop)$
    match:initial_title = ^(vesktop|Discord)$
    workspace = 2 silent
}

windowrule {
    name = workspace-discord-app
    match:initial_class = ^(discord)$
    match:initial_title = ^(Discord Updater|Discord|discord)$
    workspace = 2 silent
}

windowrule {
    name = workspace-element
    match:initial_class = ^(Element)$
    match:initial_title = ^(Element .*)$
    workspace = 2 silent
}

windowrule {
    name = workspace-telegram
    match:initial_class = ^(org.telegram.desktop)$
    match:initial_title = ^(Telegram)$
    workspace = 2 silent
}

windowrule {
    name = workspace-signal
    match:initial_class = ^(signal)$
    match:initial_title = ^(Signal)$
    workspace = 2 silent
}

# Workspace 3: Multimedia
windowrule {
    name = workspace-vlc
    match:initial_class = ^(vlc)$
    match:initial_title = ^(VLC media player)$
    workspace = 3
}

windowrule {
    name = workspace-tauon
    match:initial_class = ^(tauonmb)$
    match:initial_title = ^(Tauon)$
    workspace = 3
}

# Workspace 4: Gaming
windowrule {
    name = workspace-steam
    match:initial_class = ^(steam)$
    match:initial_title = ^(Sign in to Steam|steam|Steam)$
    workspace = 4
}

windowrule {
    name = workspace-sober
    match:initial_class = ^(org.vinegarhq.Sober)$
    match:initial_title = ^(Sober)$
    workspace = 4
}

windowrule {
    name = workspace-heroic
    match:initial_class = ^(heroic)$
    match:initial_title = ^(Heroic Games Launcher)$
    workspace = 4 silent
}

windowrule {
    name = workspace-tlauncher
    match:initial_class = ^(org-tlauncher-tlauncher-rmo-TLauncher|by-gdev-main)$
    match:initial_title = ^(TLauncher)$
    workspace = 4
}

windowrule {
    name = workspace-prismlauncher
    match:initial_class = ^(org.prismlauncher.PrismLauncher|io.github.elyprismlauncher.ElyPrismLauncher)$
    match:initial_title = ^(Prism Launcher .*|ElyPrismLauncher .*)$
    workspace = 4
}

windowrule {
    name = workspace-lutris
    match:initial_class = ^(net.lutris.Lutris)$
    match:initial_title = ^(Lutris)$
    workspace = 4
}

# Workspace 5: Virtualization
windowrule {
    name = workspace-virtmanager
    match:initial_class = ^(virt-manager)$
    match:initial_title = ^(Virtual Machine Manager)$
    workspace = 5
}


# -----------------------------------------------------
# SMART GAPS & NO BORDERS (v0.53 Native Feature)
# -----------------------------------------------------
# Uncomment bagian ini jika ingin fitur Smart Gaps aktif
# (Hilangkan border jika hanya ada 1 window tiling di workspace)

# windowrule {
#     name = smart-gaps-border
#     # Target: Tidak floating (tiled) DAN berada di workspace w[tv1] (single tiled visible)
#     match:float = false
#     match:workspace = w[tv1]
#
#     border_size = 0
#     rounding = 0
# }

# Note: Jangan lupa tambahkan rule workspace di file hyprland.conf utama:
# workspace = w[tv1], gapsout:0, gapsin:0
